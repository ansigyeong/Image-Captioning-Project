# 이미지 캡셔닝 활용 시스템

## 💻 PJT 목표

1. `인공지능`과 `머신 러닝`에 대한 이해

2. `선형 회귀` 및 `경사 하강법`에 대한 이해

3. `선형 회귀 모델` 구현

4. `이미지 캡셔닝 데이터 전처리`

5. `데이터 시각화`

   

## 💻 PJT 개요

`심층 신경망 네트워크(Deep Neural Network)`를 사용하여 `이미지 처리`와 `자연어 처리` 학습

> 인공지능 서비스를 구현하기 위해 인공지능 알고리즘에 속한 다양한 머신 러닝 방법들 중 `신경망 네트워크(Neural Network)`, 그 중 인공지능이 다시 주목 받게 만든 `심층 신경망 네트워크(Deep Neural Network)`를 사용하여 `이미지 처리`와 `자연어 처리`를 학습함



## 💻 PJT 필수 지식

##### 1. 머신 러닝, 딥러닝

##### 2. 선형 회귀(Linear Regression)

##### 3. 신경망 네트워크(Neural Network)

##### 4. Python

##### 5. 주요 라이브러리 및 프레임워크

- Numpy
- Matplotlib
- Tensorflow
- Keras



## 💻 Sub PJT 1 - 인공지능 기초 및 데이터 전처리

- 실습 환경 구축하기
- `신경망 네트워크` 기초 학습하기
- 딥러닝 알고리즘을 이해하는데 기반이 되는 `선형 회귀(Linear Regression) 기법`에 대해 학습하기
- 데이터셋
- `선형 회귀 모델`과 `신경망 네트워크(Neural Network)`를 구현하기 위해서는 `머신 러닝 방법론`에 대한 이해, 손실과 이를 `최적화`하면서 모델을 학습해가는 과정에 대한 이해가 필요함



### 1. 기능/과제 목록

1. 단순 선형 회귀 모델 구현

   - 데이터 읽기 및 시각화
   - 선형 모델 클래스 구현
   - 최적화 함수 및 손실 함수 바인딩
   - 모델 학습 함수 구현
   - 예측 및 결과 시각화

2. 이미지 캡셔닝 Configuration

   - config.py 파일 구현
   - 세팅 값 저장

3. 이미지 캡셔닝 데이터 전처리

   - 이미지 경로 및 캡션 불러오기
   - 전체 데이터셋을 분리해 저장하기
   - 저장된 데이터셋 불러오기
   - 데이터 샘플링

4. 데이터 시각화

   - 이미지와 캡션 시각화

   

### 2. 기능/과제 상세

1. 단순 선형 회귀 모델 구현

   - 데이터 읽기 및 시각화

     - Numpy, Matplotlib 라이브러리 사용
     - datasets/linear_train.npy 데이터셋 읽어오기
     - x축, y축 데이터 열을 가진 데이터셋 확인
     - 데이터 시각화

   - 선형 모델 클래스 구현

     - 위치: models/linear_model.py
     - Class명: LinearModel()
     - LinearModel 클래스는 tf.keras.Model을 상속
     - call() 호출 시, 입력 값에 대한 결과 값을 리턴

   - 최적화 함수 및 손실 함수 바인딩

     - 모델의 학습에 사용할 최적화 함수 및 손실 함수를 바인딩하여 모델을 컴파일

   - 모델 학습 함수 구현

     - 읽어 온 x축, y축 데이터를 바탕으로 아래 항목을 매개변수로 받아 모델을 학습하는 함수 구현

       > x: x축 데이터
       >
       > y: y축 데이터
       >
       > epochs: 데이터 전체에 대한 학습 반복 횟수
       >
       > batch_size: 배치의 크기

   - 예측 및 결과 시각화

     - 새로운 입력을 받으면 학습된 변수를 이용해 예측 값을 리턴하는 함수 구현
     - 테스트 입력 값(datasets/linear_test_x.npy)을 읽어와 이에 해당하는 예측 값을 구하고 시각화

     

2. 이미지 캡셔닝 Configuration

   - config.py 파일 구현
     - 이미지 캡셔닝 모델 구현에 필요한 세팅 값들을 저장해 놓은 config.py 파일 생성(argparse 모듈 이용)
     - 세팅 값의 예시는 캡션 데이터가 저장된 csv 파일의 경로, 실제 이미지 파일들이 저장된 경로 등이 있을 수 있음(전체적인 기능 명세에 따라 필요한 세팅 값들을 적절히 추가하기)
   - 세팅 값 저장
     - Configuration 변수들은 추후 다양하게 바꿔가며 실험되기 때문에 train.py를 실행할 때마다 당시의 세팅 값들을 저장하는 함수를 구현함
     - 해당 함수는 utils/utils.py에 구현함

   

3. 이미지 캡셔닝 데이터 전처리

   - 이미지 경로 및 캡션 불러오기
     - 캡션 파일을 읽어와 이미지 파일 경로와 캡션을 리턴하는 함수를 구현함
     - 이미지 파일의 이름과 각 파일에 해당하는 캡션이 저장된 csv 파일을 읽어옴
     - 파일에 있는 이미지 파일 이름과 캡션을 분리해 각각을 리스트로 만들어 리턴함(하나의 리스트로 만들어 관리해도 됨)
   - 전체 데이터셋을 분리해 저장하기
     - 전체 데이터를 학습용 및 테스트용 데이터로 랜덤하게 분리해 각각을 datasets 폴도에 저장하는 함수를 구현함
   - 저장된 데이터셋 불러오기
     - 분리해 저장해놓은 데이터를 읽어와 이미지 경로와 이에 해당하는 캡션의 목록을 리턴하는 함수를 구현함
     - 이때 함수의 인자에 따라 학습용 데이터 또는 테스트 데이터를 불러올 수 있도록 함
   - 데이터 샘플링
     - 이미지 경로와 캡션 데이터를 입력으로 받아 이중 지정한 개수 또는 비율만큼의 데이터를 샘플링할 수 있는 함수를 구현함(샘플링은 선택적으로 사용할 수 있게 함)

   

4. 데이터 시각화

   - 이미지와 캡션 시각화
     - 이미지 파일과 캡션을 입력으로 받아 이를 시각화하는 함수를 구현함



## 💻 Sub PJT 2 - 이미지 캡셔닝 기능 구현

- 이미지 캡셔닝(Image Captioning) 모델 구현 => 이미지를 묘사하는 문장을 생성하는 것

  <인공신경망을 확장시켜 학습할 것>

  - `컨볼루션 신경망(Convolutional Neural Networks)`
    - 이미지 데이터에 적합한 신경망
    - 이미지에서 물체의 형태를 인지하거나 색깔을 구별하는 등 특성을 뽑아내는 신경망
  - `순환 신경망(Recurrent Neural Networks)`
    - 순서가 있는 데이터에 적합한 신경망
    - 컨볼루션 신경망이 사용되며 뽑아낸 특성을 바탕으로 문장을 생성하는 신경망



## 💻 Sub PJT 3 - 이미지 캡셔닝 고도화 및 서비스 확장

다양한 AI 서비스 만들기

> 예시

- 이미지 전체에서 특성을 뽑아내던 모델에 부분 인식을 더해 Detection 모델로 발전시킬 수 있음
- 이미지에서 검출된 각각의 물체에 대해 캡션을 생성하는 모델을 만들기
- 이미지에서 뽑은 캡션으로 원본 이미지를 분류하거나 검색하기
- 이미지에서 캡션을 생성하던 것과 반대로 캡션이 들어오면 이미지를 생성해내는 모델 만들기
  - GAN(Generative Adversarial Network) 기술을 이용해 성능을 향상시킬 수 있음
- 해석 가능한 인공지능 측면에서는 해당 캡션의 각 단어들이 이미지의 어느 부분을 보고 생성되었는지 확인할 수 있는 Attention을 모델에 추가해보거나 순환 신경망을 Transformer라는 모델로 대체하여 성능을 향상시킬 수 있음
- Video Captioning
- Machine Translation
- Text Summarization

